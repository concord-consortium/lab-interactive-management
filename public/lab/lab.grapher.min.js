(function(){var e,t,n;(function(r){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(e){if(d(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!d(a,e)&&!d(c,e))throw new Error("No "+e);return a[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(e,t,n,i){var s,l,h,p,v,g=[],w;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")g[v]=u.require(e);else if(l==="exports")g[v]=u.exports(e),w=!0;else if(l==="module")s=g[v]=u.module(e);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=n.apply(a[e],g);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!w)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):b(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},n=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../../vendor/almond/almond",function(){}),n("lab.version",["require"],function(e){return{repo:{branch:"master",commit:{sha:"8973b6b862ec8ca45238af1dce8b781036c02a43",short_sha:"8973b6b8",url:"https://github.com/concord-consortium/lab/commit/8973b6b8",author:"Stephen Bannasch",email:"stephen.bannasch@gmail.com",date:"2013-07-10 03:36:02 +0000",short_message:"simplify setup:server cap task",message:"simplify setup:server cap task"},dirty:!1}}}),n("common/actual-root",[],function(){var e=/^(\/.+?\/)(interactives|embeddable)\.html$/,t=/(\/.+?\/)(doc|examples|experiments)(\/\w+)*?\/\w+\.html/,n;return n=document.location.pathname.match(e),n&&n[1]?n[1]:(n=document.location.pathname.match(t),n&&n[1]||"/")}),n("lab.config",["require","common/actual-root"],function(e){var t=e("common/actual-root"),n;return n={sharing:!0,logging:!0,tracing:!1,home:"http://lab.concord.org",homeForSharing:null,homeInteractivePath:"/interactives.html",homeEmbeddablePath:"/embeddable.html",actualRoot:"",utmCampaign:null,fontface:"Lato",hostName:"lab.dev.concord.org",dataGamesProxyPrefix:"DataGames/Games/concord/lab.dev/",authoring:!1,environment:"development"},n.actualRoot=t,n}),n("grapher/core/axis",["require"],function(e){return{numberWidthUsingFormatter:function(e,t,n,r,i){var s,o,u,a,f,l;return s=e.append("svg").attr("width",t).attr("height",n).attr("class","graph"),o=s.append("g").append("text").attr("class","axis").attr("x",-r/4+"px").attr("dy",".35em").attr("text-anchor","end").text(i),l=o.node(),l.getBBox?(u=o.node().getBBox(),a=u.width,f=u.height):(a=0,f=0),s.remove(),[a,f]},axisProcessDrag:function(e,t,n){var r,i,s=n,o=0,u=n[0],a=n[1],f=a-u;if(t!==0)if(u>=0&&a>u)o=u,r=e-o,i=r*.4+o,t>i&&(change=r/(t-o),f=a-o,s=[u,u+f*change]);else if(u<0&&a>0){o=0,r=e-o,i=r*.4+o;if(e>=0&&t>i||e<0&&t<i)change=r/(t-o),s=[u*change,a*change]}else u<0&&a<0&&(o=a,r=e-o,i=r*.4+o,t<i&&(change=r/(t-o),f=u-o,s=[a+f*change,a]));return s}}}),n("grapher/core/graph",["require","grapher/core/axis"],function(e){var t=e("grapher/core/axis"),n={autoscale:"Show all data (autoscale)"};return function(r,s,o,u){function zt(e,t,n){if(t||!s)s=$t(t);Wt(e,n),s.xrange=s.xmax-s.xmin,s.yrange=s.ymax-s.ymin,Object.prototype.toString.call(s.title)==="[object Array]"?R=s.title:R=[s.title],R.reverse(),D=d3.format(s.xFormatter),P=d3.format(s.yFormatter),Pt=s.sampleInterval,dataSampleStart=s.dataSampleStart,Tt=s.strokeWidth,O=s.xTickCount,M=s.yTickCount,_t=[];switch(s.dataType){case"fake":Mt=Zt(),_t=[Mt];break;case"points":Qn(s.dataPoints);break;case"samples":Gn(s.dataSamples,Pt,dataSampleStart)}Ot=[],At=null,en(Mt.length)}function Wt(e,t){e&&(f=d3.select(e),l=f.node(),c=$(l),h=f.property("clientWidth"),p=f.property("clientHeight")),t&&(o=t),m!==undefined&&(m.remove(),m=undefined),I!==undefined&&(I.remove(),I=undefined),U!==undefined&&(U.remove(),U=undefined),s.dataChange?G="ns-resize":G="crosshair",Xt(),Ct=NaN,kt=NaN,Lt=null}function Xt(e,t){!e&&!t?(h=Math.max(f.property("clientWidth"),120),p=Math.max(f.property("clientHeight"),62)):(h=e,l.style.width=h+"px",t?(p=t,l.style.height=p+"px"):(l.style.height="100%",t=f.property("clientHeight"),p=t,l.style.height=p+"px")),Jt()}function Vt(){Xt(),Y=parseFloat(c.css("font-size")),s.fontScaleRelativeToParent||c.css("font-size",.5+Nt.value/6+"em"),Y=parseFloat(c.css("font-size")),Z=Y/2,et=Y/4,m===undefined?(tt=Y,nt=Y,rt=Y,it=Y):(tt=parseFloat($("svg.graph text.title").css("font-size")),nt=parseFloat($("svg.graph text.axis").css("font-size")),rt=parseFloat($("svg.graph text.xlabel").css("font-size")),it=parseFloat($("svg.graph text.ylabel").css("font-size"))),L===undefined?(st=[Y,Y],ylabelMetrics=[Y*2,Y]):(st=t.numberWidthUsingFormatter(f,h,p,nt,Kt(L.ticks(O),D)),ylabelMetrics=t.numberWidthUsingFormatter(f,h,p,nt,Kt(A.ticks(M),P))),ut=st[0],ft=st[1],at=ylabelMetrics[0],lt=ylabelMetrics[0],pt=ut*.6,mt=ft*1.1,ct=mt+ft*1.3,dt=ct-ft/3,gt=at+ft/4,ht=gt+lt,vt=-(gt+lt/4);switch(Nt.value){case 0:d={top:Z,right:Z,bottom:Y,left:Y};break;case 1:d={top:s.title?tt*1.8:Y,right:Z,bottom:Y,left:Y};break;case 2:d={top:s.title?tt*1.8:Y,right:pt,bottom:nt*1.25,left:at*1.25},O=Math.max(6,s.xTickCount/2),M=Math.max(6,s.yTickCount/2);break;case 3:d={top:s.title?tt*1.8:Y,right:pt,bottom:s.xlabel?ct:nt*1.25,left:s.ylabel?ht:at};break;default:d={top:s.title?tt*1.8:Y,right:pt,bottom:s.xlabel?ct:nt*1.25,left:s.ylabel?ht:at}}Nt.value>2?d.top+=(R.length-1)*Nt.value/3*Nt.value/3*Y:R=[R[0]],v={width:h-d.left-d.right,height:p-d.top-d.bottom},L=d3.scale[s.xscale]().domain([s.xmin,s.xmax]).range([0,v.width]),s.xscale==="pow"&&L.exponent(s.xscaleExponent),A=d3.scale[s.yscale]().domain([s.ymin,s.ymax]).nice().range([v.height,0]).nice(),s.yscale==="pow"&&A.exponent(s.yscaleExponent),Qt(),Gt(),_=d3.svg.line().x(function(e,t){return L(Mt[t][0])}).y(function(e,t){return A(Mt[t][1])})}function $t(e){if(e)for(var t in Ht)e[t]===undefined&&(e[t]=Ht[t]);else e=Ht;return e.axisShift<1&&(e.axisShift=1),e}function Jt(){s.responsiveLayout?h<=Nt.icon?(Nt.category="icon",Nt.value=0):h<=Nt.tiny?(Nt.category="tiny",Nt.value=1):h<=Nt.small?(Nt.category="small",Nt.value=2):h<=Nt.medium?(Nt.category="medium",Nt.value=3):(Nt.category="large",Nt.value=4):(Nt.category="large",Nt.value=4)}function Kt(e,t,n){var r=0,i=0,s,o,u;n=n||5;for(u=0;u<e.length;u++)s=t(+e[u].toPrecision(n)),s=s.replace(/^\s\s*/,"").replace(/\s\s*$/,""),o=s.length,o>r&&(r=o,i=u);return t(e[i])}function Qt(){L.domain([s.xmin,s.xmax]).range([0,v.width])}function Gt(){A.domain([s.ymin,s.ymax]).range([v.height,0])}function Yt(){var e=L.domain(),t=A.domain();s.xmax=e[1],s.xmin=e[0],s.ymax=t[1],s.ymin=t[0]}function Zt(){var e=s.yrange/2,t=e/2,n;return s.datacount=v.width/30,s.xtic=s.xrange/s.datacount,s.ytic=s.yrange/s.datacount,n=d3.range(s.datacount).map(function(n){return[n*s.xtic+s.xmin,s.ymin+t+Math.random()*e]}),n}function en(e){return typeof e=="number"&&(Dt=e),typeof Dt!="number"&&(Dt=Mt.length-1),Dt}function tn(e,t,n){var r=0,i=[];t=t||1,n=n||0;for(r=0;r<e.length;r++)i.push([r*t+n,e[r]]);return i}function nn(e){o=e,e?q.text(e):q.text("")}function rn(){F=f.append("div"),F.attr("class","button-layer").style("z-index",3).append("a").attr({"class":"autoscale-button",title:n.autoscale}).on("click",function(){An()}).append("i").attr("class","icon-picture"),sn()}function sn(){F.style({width:Y*1.75+"px",height:Y*1.25+"px",top:d.top+Z+"px",left:d.left+(v.width-Y*2)+"px"})}function on(){m=f.append("svg").attr("width",h).attr("height",p).attr("class","graph").style("z-index",2),g=m.append("g").attr("transform","translate("+d.left+","+d.top+")"),y=g.append("rect").attr("class","plot").attr("width",v.width).attr("height",v.height).attr("pointer-events","all").attr("fill","rgba(255,255,255,0)").on("mousemove",wn).on("mousedown",Sn).on("touchstart",Sn),y.call(d3.behavior.zoom().x(L).y(A).on("zoom",ln)),I=f.append("div").attr("class","background").style({width:v.width+"px",height:v.height+"px",top:d.top+"px",left:d.left+"px","z-index":0}),jn(),b=g.append("svg").attr("class","viewbox").attr("top",0).attr("left",0).attr("width",v.width).attr("height",v.height).attr("viewBox","0 0 "+v.width+" "+v.height),x=b.append("line").attr("stroke",H).attr("stroke-dasharray","2,2").attr("y1",0).attr("y2",v.height).attr("x1",function(e){return At===null?0:At[0]}).attr("x2",function(e){return At===null?0:At[0]}).attr("class","ruler hidden"),T=b.append("line").attr("stroke",H).attr("stroke-dasharray","2,2").attr("x1",0).attr("x2",v.width).attr("y1",function(e){return At===null?0:At[1]}).attr("y2",function(e){return At===null?0:At[1]}).attr("class","ruler hidden"),bt=m.append("rect").attr("class","draggable-axis").attr("x",d.left-gt).attr("y",d.top).attr("rx",lt/6).attr("width",gt).attr("height",v.height).attr("pointer-events","all").style("cursor","row-resize").on("mousedown",Nn).on("touchstart",Nn),Et=bt.append("title"),yt=m.append("rect").attr("class","draggable-axis").attr("x",d.left).attr("y",v.height+d.top).attr("rx",lt/6).attr("width",v.width).attr("height",mt).attr("pointer-events","all").style("cursor","col-resize").on("mousedown",Tn).on("touchstart",Tn),wt=yt.append("title"),Nt.value<=2&&s.ylabel&&wt.text(s.xlabel),Nt.catefory&&s.ylabel&&Et.text(s.ylabel),fn(),Rt=b.append("g").attr("class","brush"),s.title&&Nt.value>0?(w=g.selectAll("text").data(R,function(e){return e}),w.enter().append("text").attr("class","title").text(function(e){return e}).attr("x",function(e){return v.width/2-Math.min(v.width,an(this))/2}).attr("dy",function(e,t){return-t*tt-Z+"px"}),N=w.append("title").text("")):s.title&&(N=y.append("title").text(s.title)),s.xlabel&&Nt.value>2&&(E=g.append("text").attr("class","axis").attr("class","xlabel").text(s.xlabel).attr("x",v.width/2).attr("y",v.height).attr("dy",dt+"px").style("text-anchor","middle")),s.ylabel&&Nt.value>2&&(S=g.append("g").append("text").attr("class","axis").attr("class","ylabel").text(s.ylabel).style("text-anchor","middle").attr("transform","translate("+vt+" "+v.height/2+") rotate(-90)"),Nt.category==="small"&&bt.append("title").text(s.ylabel)),d3.select(l).on("mousemove.drag",kn).on("touchmove.drag",kn).on("mouseup.drag",Ln).on("touchend.drag",Ln),q=g.append("text").attr("class","graph-notification").text(o).attr("x",v.width/2).attr("y",v.height/2).style("text-anchor","middle"),yn(),bn()}function un(){g.attr("width",h).attr("height",p).attr("transform","translate("+d.left+","+d.top+")"),y.attr("width",v.width).attr("height",v.height),I.style({width:v.width+"px",height:v.height+"px",top:d.top+"px",left:d.left+"px","z-index":0}),b.attr("top",0).attr("left",0).attr("width",v.width).attr("height",v.height).attr("viewBox","0 0 "+v.width+" "+v.height),bt.attr("x",d.left-gt).attr("y",d.top-lt/2).attr("width",gt).attr("height",v.height+lt),yt.attr("x",d.left).attr("y",v.height+d.top).attr("width",v.width).attr("height",mt),fn(),s.title&&Nt.value>0?(w.attr("x",function(e){return v.width/2-Math.min(v.width,an(this))/2}).attr("dy",function(e,t){return-t*tt-Z+"px"}),N.text("")):s.title&&N.text(s.title),s.xlabel&&Nt.value>2?(E.attr("x",v.width/2).attr("y",v.height).attr("dy",dt+"px"),wt.text("")):wt.text(s.xlabel),s.ylabel&&Nt.value>2?(S.attr("transform","translate("+vt+" "+v.height/2+") rotate(-90)"),Et.text("")):Et.text(s.ylabel),q.attr("x",v.width/2).attr("y",v.height/2),g.selectAll("g.x").remove(),g.selectAll("g.y").remove(),yn(),bn(),Fn()}function an(e){return e.getComputedTextLength?e.getComputedTextLength():100}function fn(){Nt.value<=1?(yt.style({fill:"rgba(196, 196, 196, 0.2)"}),bt.style({fill:"rgba(196, 196, 196, 0.2)"})):(yt.style({fill:null}),bt.style({fill:null}))}function ln(){var e=g.selectAll("g.x").data(L.ticks(O),String).attr("transform",B),t=e.enter().insert("g","a").attr("class","x").attr("transform",B);t.append("line").attr("stroke",H).attr("y1",0).attr("y2",v.height),Nt.value>1&&t.append("text").attr("class","axis").attr("y",v.height).attr("dy",nt+"px").attr("text-anchor","middle").text(D).on("mouseover",function(){d3.select(this).style("font-weight","bold")}).on("mouseout",function(){d3.select(this).style("font-weight","normal")}),e.exit().remove();var n=g.selectAll("g.y").data(A.ticks(M),String).attr("transform",j),r=n.enter().insert("g","a").attr("class","y").attr("transform",j).attr("background-fill","#FFEEB6");r.append("line").attr("stroke",H).attr("x1",0).attr("x2",v.width);if(Nt.value>1){if(s.yscale==="log"){var i=r[0].length;i>100?r=r.filter(function(e){return!!e.toString().match(/(\.[0]*|^)[1]/)}):i>50?r=r.filter(function(e){return!!e.toString().match(/(\.[0]*|^)[12]/)}):r=r.filter(function(e){return!!e.toString().match(/(\.[0]*|^)[125]/)})}r.append("text").attr("class","axis").attr("x",-nt/4+"px").attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(P).on("mouseover",function(){d3.select(this).style("font-weight","bold")}).on("mouseout",function(){d3.select(this).style("font-weight","normal")})}n.exit().remove(),y.call(d3.behavior.zoom().x(L).y(A).on("zoom",ln)),cn()}function cn(e){en(e),Rn(Dt),yn(),d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function hn(e){en(e),pn()}function pn(e){var t,n=L.domain(),r=Math.round(n[0]),i=Math.round(n[1]),o=Math.max(0,r),u=n[1]-n[0],a=u*.95,f;en(e),f=Mt[Dt-1][0],K?(K=J(),K?(vn(),ln()):cn(Dt)):f>n[0]+a?(J=dn(a*.9,s.axisShift),K=J(),ln()):f<n[1]-a&&Dt<Mt.length&&r>0?(J=dn(a*.9,s.axisShift,-1),K=J(),ln()):f<n[0]?(J=dn(a*.1,1,-1),K=J(),ln()):cn(Dt)}function dn(e,t,n){var r=L.domain()[0],i=L.domain()[1],s=1/t,o=0;return function(){var t;return n=n||1,o+=s,t=e*Q(o),n>0?(L.domain([r+t,i+t]),Yt(),L.domain()[0]<r+e):(L.domain([r-t,i-t]),Yt(),L.domain()[0]>r-e)}}function vn(){isNaN(Ct)||(Ct=NaN),isNaN(kt)||(kt=NaN)}function mn(e){return cs=[],e===At&&cs.push("selected"),cs.length===0?null:cs.join(" ")}function gn(){var e=L.domain(),t=L.range();St=(t[1]-t[0])/(e[1]-e[0]),St=Math.min(St,6),xt=St/4}function yn(){var e,t=null;s.markAllDataPoints&&Nt.value>1?t=Mt:s.markNearbyDataPoints&&Nt.value>1&&(t=Ot.slice(0),At!==null&&t.indexOf(At)==-1&&t.push(At)),t!==null&&(gn(),e=g.select("svg").selectAll("circle").data(t),e.enter().append("circle").attr("class",mn).attr("cx",function(e){return L(e[0])}).attr("cy",function(e){return A(e[1])}).attr("r",St).style("stroke-width",xt).style("cursor",G).on("mousedown.drag",Cn).on("touchstart.drag",Cn).append("title").text(function(e){return"( "+D(e[0])+", "+P(e[1])+" )"}),e.attr("class",mn).attr("cx",function(e){return L(e[0])}).attr("cy",function(e){return A(e[1])}).select("title").text(function(e){return"( "+D(e[0])+", "+P(e[1])+" )"}),e.exit().remove()),bn()}function bn(){s.showRulersOnSelection&&At!==null?(x.attr("y1",0).attr("y2",v.height).attr("x1",function(e){return At===null?0:L(At[0])}).attr("x2",function(e){return At===null?0:L(At[0])}).attr("class",function(e){return"ruler"+(At===null?" hidden":"")}),T.attr("x1",0).attr("x2",v.width).attr("y1",function(e){return At===null?0:A(At[1])}).attr("y2",function(e){return At===null?0:A(At[1])}).attr("class",function(e){return"ruler"+(At===null?" hidden":"")})):(x.attr("class","ruler hidden"),T.attr("class","ruler hidden"))}function wn(){if(s.markNearbyDataPoints){var e=d3.mouse(g.node()),t=L.invert(Math.max(0,Math.min(v.width,e[0]))),n,r,o,u;Ot=[];for(i=0;i<_t.length;i++)Mt=_t[i],n=En(t,i),n!==null&&(r=Mt.indexOf(n),o=r-s.extraCirclesVisibleOnHover,u=r+(s.extraCirclesVisibleOnHover+1),o<0&&(o=0),u>Mt.length-1&&(u=Mt.length),Ot=Ot.concat(Mt.slice(o,u)));cn()}}function En(e,t){if(typeof t=="undefined"||t===null)t=0;Mt=_t[t];if(Mt.length===0)return null;var n=0,r=Mt.length-1,i,s,o,u,a;while(n<r)i=Math.floor((n+r)/2),Mt[i][0]<e?n=i+1:r=i;return o=Mt[i-1],u=Mt[i],a=Mt[i+1],typeof o!="undefined"&&Math.abs(o[0]-e)<=Math.abs(u[0]-e)?o:typeof a=="undefined"||Math.abs(u[0]-e)<=Math.abs(a[0]-e)?u:a}function Sn(){var e;d3.event.preventDefault(),d3.select("body").style("cursor","move");if(d3.event.altKey){y.style("cursor","nesw-resize");if(d3.event.shiftKey&&s.addData){e=d3.mouse(g.node());var t=[];t[0]=L.invert(Math.max(0,Math.min(v.width,e[0]))),t[1]=A.invert(Math.max(0,Math.min(v.height,e[1]))),Mt.push(t),Mt.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}),At=t,cn()}else e=d3.mouse(g.node()),Ct=L.invert(e[0]),kt=A.invert(e[1]),Lt=!1,d3.event.stopPropagation()}}function xn(){return!1}function Tn(){l.focus(),document.onselectstart=xn,d3.event.preventDefault();var e=d3.mouse(g.node());Ct=L.invert(e[0])}function Nn(){l.focus(),d3.event.preventDefault(),document.onselectstart=xn;var e=d3.mouse(g.node());kt=A.invert(e[1])}function Cn(e){l.focus(),d3.event.preventDefault(),document.onselectstart=xn,At===e?At=Lt=null:At=Lt=e,cn()}function kn(){var e=d3.mouse(g.node()),n,r,i,o,u,a,f;document.onselectstart=function(){return!0},d3.event.preventDefault(),Lt&&(s.dataChange?Lt[1]=A.invert(Math.max(0,Math.min(v.height,e[1]))):(n=Mt.indexOf(Lt),n&&n<Mt.length-1&&(r=L.invert(e[0]),i=Lt[0],o=Mt[n+1],u=Mt[n-1],a=i-(i-u[0])/2,f=i+(o[0]-i)/2,r<a?(Lt=u,At=Lt):r>f&&(Lt=o,At=Lt))),Yt(),cn()),isNaN(Ct)||(d3.select("body").style("cursor","col-resize"),y.style("cursor","col-resize"),K?L.domain(t.axisProcessDrag(Ct,L.invert(e[0]),L.domain())):L.domain(t.axisProcessDrag(Ct,L.invert(e[0]),L.domain())),Yt(),gn(),ln(),d3.event.stopPropagation()),isNaN(kt)||(d3.select("body").style("cursor","row-resize"),y.style("cursor","row-resize"),A.domain(t.axisProcessDrag(kt,A.invert(e[1]),A.domain())),Yt(),ln(),d3.event.stopPropagation())}function Ln(){d3.select("body").style("cursor","auto"),y.style("cursor","auto"),document.onselectstart=function(){return!0},isNaN(Ct)||(ln(),Ct=NaN),isNaN(kt)||(ln(),kt=NaN),Lt=null}function An(){var e,t,n,r,i,o,u=Infinity,a=-Infinity,f=Infinity,l=-Infinity,c,h;if(Mt.length<2)return;for(e=0;e<_t.length;e++){Mt=_t[e];for(t=0,n=Mt.length;t<n;t++)r=Mt[t],i=r[0],o=r[1],i<u&&(u=i),i>a&&(a=i),o<f&&(f=o),o>l&&(l=o)}h=function(e,t){return e<0?-Math.pow(-e,t):Math.pow(e,t)};switch(s.yscale){case"linear":c=function(e){return e};break;case"log":f=Math.log(f)/Math.log(10),l=Math.log(l)/Math.log(10),c=function(e){return Math.pow(10,e)};break;case"pow":f=h(f,s.yscaleExponent),l=h(l,s.yscaleExponent),c=function(e){return h(e,1/s.yscaleExponent)}}L.domain([u,a]).nice(),A.domain([c(f-.15*(l-f)),c(l+.15*(l-f))]).nice(),Yt(),ln()}function On(e){return arguments.length?(e===null?jt=!1:e.length===0?(jt=!0,Bt.xmin=Infinity,Bt.xmax=Infinity):(jt=!0,Bt.xmin=e[0],Bt.xmax=e[1]),Bn(),qt&&qt(On()),a):jt?Bt.xmax===Infinity&&Bt.xmin===Infinity?[]:[Bt.xmin,Bt.xmax]:null}function Mn(){return jt}function _n(e){return arguments.length?(e=!!e,Ft!==e&&(Ft=e,Bn()),a):Ft}function Dn(e){return arguments.length?(e=!!e,It!==e&&(It=e,Bn()),a):It}function Pn(e){return arguments.length?(qt=e,a):qt}function Hn(){var e;It&&(e=Ut.extent(),On(e[0]!==e[1]?e:[]))}function Bn(){jt&&Ft?(Ut=Ut||d3.svg.brush().x(L).extent([Bt.xmin||0,Bt.xmax||0]).on("brush",Hn),Rt.call(Ut.extent([Bt.xmin||0,Bt.xmax||0])).style("display","inline").style("pointer-events",It?"all":"none").selectAll("rect").attr("height",v.height)):Rt.style("display","none")}function jn(){U=f.append("canvas"),z=U.node(),Fn()}function Fn(){U.attr("class","overlay").style({position:"absolute",width:v.width+"px",height:v.height+"px",top:d.top+"px",left:d.left+"px","z-index":1}),z=U.node(),z.width=v.width,z.height=v.height,z.top=d.top,z.left=d.left,qn(),Rn(Dt)}function In(){z.getContext&&(z.width=z.width,W.fillStyle=X,W.fillRect(0,0,z.width,z.height),W.strokeStyle="rgba(255,65,0, 1.0)")}function qn(){z.getContext&&(W=z.getContext("2d"),W.globalCompositeOperation="source-over",W.lineWidth=1,W.fillStyle=X,W.fillRect(0,0,z.width,z.height),W.strokeStyle="rgba(255,65,0, 1.0)")}function Rn(e){var t,n,r,i,o,u,a,f=A(1e-5),l=s.lines,c=s.bars,h=2*Math.PI,p=_t[0].length,d=_t.length,v,m,g,y;if(typeof z.getContext=="undefined")return;en(e),In(),W.fillRect(0,0,z.width,z.height);if(p===0)return;v=L.domain()[0],m=L.domain()[1],g=Math.max(0,v);if(l)for(t=0;t<d;t++){Mt=_t[t],a=0;for(n=0;n<p;n++){if(Mt[n][0]>=v)break;a++}a>0&&--a;if(a>=p)break;o=L(Mt[a][0]),u=A(Mt[a][1]),Un(t),W.beginPath(),W.moveTo(o,u),i=Mt[a][0],a++;for(;a<e;a++){i=Mt[a][0],o=L(i),u=A(Mt[a][1]),W.lineTo(o,u);if(i>=m)break}W.stroke();if(a<p&&i<m){Un(t,!0);for(;a<p;a++){i=Mt[a][0],o=L(i),u=A(Mt[a][1]),W.lineTo(o,u);if(i>=m)break}W.stroke()}}else if(c)for(t=0;t<d;t++){Mt=_t[t],Un(t),pointStop=e-1;for(a=g;a<pointStop;a++){o=L(Mt[a][0]),u=A(Mt[a][1]);if(u===0)continue;W.beginPath(),W.moveTo(o,f),W.lineTo(o,u),W.stroke()}pointStop=Mt.length-1;if(a<pointStop){Un(t,!0);for(;a<pointStop;a++)o=L(Mt[a][0]),u=A(Mt[a][1]),W.beginPath(),W.moveTo(o,f),W.lineTo(o,u),W.stroke()}}else for(t=0;t<d;t++){Mt=_t[t],y=0,zn(t),Un(t,!0),pointStop=e-1;for(a=0;a<pointStop;a++)o=L(Mt[a][0]),u=A(Mt[a][1]),W.arc(o,u,1,0,h,!1),W.fill();pointStop=Mt.length-1;if(a<pointStop){zn(t,!0),Un(t,!0);for(;a<pointStop;a++)o=L(Mt[a][0]),u=A(Mt[a][1]),W.arc(o,u,1,0,h,!1),W.fill()}}}function Un(e,t){var n=t?.4:1;switch(e){case 0:W.strokeStyle="rgba(160,00,0,"+n+")";break;case 1:W.strokeStyle="rgba(44,160,0,"+n+")";break;case 2:W.strokeStyle="rgba(44,0,160,"+n+")"}}function zn(e,t){var n=t?.4:1;switch(e){case 0:W.fillStyle="rgba(160,00,0,"+n+")";break;case 1:W.fillStyle="rgba(44,160,0,"+n+")";break;case 2:W.fillStyle="rgba(44,0,160,"+n+")"}}function Wn(e){Jn(e),en(Mt.length),hn()}function Xn(e){Kn(e),en(Mt.length),hn()}function Vn(e){var t=Mt.length,n=(t+dataSampleStart)*Pt,r=[n,e];Mt.push(r),en(Mt.length),hn()}function $n(e){Mt.push(e),en(Mt.length),hn()}function Jn(e){if(Object.prototype.toString.call(e[0][0])==="[object Array]"){for(var t=0;t<e.length;t++)Mt=_t[t],Mt.push.apply(Mt,e[t]),_t[t]=Mt;Mt=_t[0]}else Mt.push.apply(Mt,e),_t=[Mt]}function Kn(e){var t,n;if(Object.prototype.toString.call(e[0])==="[object Array]"){for(n=0;n<e.length;n++)_t[n]||_t.push([]),Mt=_t[n],t=Mt.length*Pt,Mt.push.apply(Mt,tn(e[n],Pt,t)),_t[n]=Mt;Mt=_t[0]}else for(n=0;n<e.length;n++)_t[n]||_t.push([]),t=_t[n].length*Pt,_t[n].push([t,e[n]])}function Qn(e){function t(e){var t=[];return e.forEach(function(e){t.push(e)}),t}_t=[];if(!e||e.length===0){Mt=[],_t=[Mt];return}if(Object.prototype.toString.call(e[0][0])==="[object Array]"){for(var n=0;n<e.length;n++)_t.push(t(e[n]));Mt=_t[0]}else Mt=e,_t=[t(Mt)]}function Gn(e,t,n){_t=[];if(Object.prototype.toString.call(e[0])==="[object Array]"){for(var r=0;r<e.length;r++)_t.push(tn(e[r],t,n));Mt=_t[0]}else Mt=tn(e,t,n),_t=[Mt];Pt=t,dataSampleStart=n}function Yn(e){Qn(e)}function Zn(e){Gn(e,Pt,dataSampleStart)}function er(e){Mt.length&&(Mt.splice(e,1),Dt>=Mt.length&&(Dt=Mt.length-1))}function tr(){m.node().addEventListener("keydown",function(e){if(!At)return!1;if(e.type=="keydown"){switch(e.keyCode){case 8:case 46:if(s.dataChange){var t=Mt.indexOf(At);er(t),At=Mt.length?Mt[t>0?t-1:0]:null,cn()}e.preventDefault(),e.stopPropagation()}e.preventDefault()}})}function nr(){s.title&&w&&w.text(s.title)}function rr(){s.xlabel&&E&&E.text(s.xlabel)}function ir(){s.ylabel&&S?S.text(s.ylabel):S.style("display","none")}function sr(){Vt(),m===undefined?on():un(),s.showButtons&&(F||rn(),sn()),ln()}function or(e,t,n){return arguments.length?zt(e,t,n):zt(),sr(),sr(),tr(),a}function ur(e,t){return Xt(e,t),Wt(),sr(),a}var a={},f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H=function(e){return e?"#ccc":"#666"},B=function(e){return"translate("+L(e)+",0)"},j=function(e){return"translate(0,"+A(e)+")"},F,I,q,R=[],U,z,W,X="rgba(255,255,255, 0.0)",V={},J,K=!1,Q=d3.ease("cubic"),G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt={category:"medium",value:3,icon:120,tiny:240,small:480,medium:960,large:1920},Ct=NaN,kt=NaN,Lt=null,At=null,Ot=[],Mt=[],_t,Dt,Pt,Ht={showButtons:!0,responsiveLayout:!1,fontScaleRelativeToParent:!0,dataType:"points",dataPoints:[],dataSamples:[],sampleInterval:1,dataSampleStart:0,title:"graph",xlabel:"x-axis",ylabel:"y-axis",xmax:10,xmin:0,ymax:10,ymin:0,xTickCount:10,yTickCount:10,xFormatter:".3s",yFormatter:".3r",xscale:"linear",yscale:"linear",xscaleExponent:.5,yscaleExponent:.5,axisShift:10,markAllDataPoints:!1,markNearbyDataPoints:!1,extraCirclesVisibleOnHover:2,showRulersOnSelection:!1,strokeWidth:2,dataChange:!1,addData:!1,notification:!1,lines:!0,bars:!1},Bt={xmin:null,xmax:null,ymin:null,ymax:null},jt=!1,Ft=!1,It=!0,qt,Rt,Ut;return a={update:cn,repaint:sr,reset:or,redraw:ln,resize:ur,notify:nn,selectionDomain:On,selectionVisible:_n,selectionListener:Pn,selectionEnabled:Dn,hasSelection:Mn,brushElement:function(){return Rt},brushControl:function(){return Ut},brushListener:function(){return Hn},scale:Xt,updateOrRescale:hn,xDomain:function(e){return arguments.length?(L.domain(e),Qt&&(Qt(),ln()),a):L.domain()},yDomain:function(e){return arguments.length?(A.domain(e),Gt&&(Gt(),ln()),a):A.domain()},xmin:function(e){return arguments.length?(s.xmin=e,s.xrange=s.xmax-s.xmin,Qt&&(Qt(),ln()),a):s.xmin},xmax:function(e){return arguments.length?(s.xmax=e,s.xrange=s.xmax-s.xmin,Qt&&(Qt(),ln()),a):s.xmax},ymin:function(e){return arguments.length?(s.ymin=e,s.yrange=s.ymax-s.ymin,Gt&&(Gt(),ln()),a):s.ymin},ymax:function(e){return arguments.length?(s.ymax=e,s.yrange=s.ymax-s.ymin,Gt&&(Gt(),ln()),a):s.ymax},xLabel:function(e){return arguments.length?(s.xlabel=e,rr(),a):s.xlabel},yLabel:function(e){return arguments.length?(s.ylabel=e,ir(),a):s.ylabel},title:function(e){return arguments.length?(s.title=e,nr(),a):s.title},width:function(e){return arguments.length?(v.width=e,a):v.width},height:function(e){return arguments.length?(v.height=e,a):v.height},elem:function(e){return arguments.length?(f=d3.select(e),graph(f),a):f},numberOfPoints:function(){return Mt?Mt.length:!1},addPoints:Wn,addPoint:$n,resetPoints:Yn,addSamples:Xn,addSample:Vn,resetSamples:Zn},zt(r,s,o),l&&(sr(),sr()),a}}),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=r.unshift,l=i.toString,c=i.hasOwnProperty,h=r.forEach,p=r.map,d=r.reduce,v=r.reduceRight,m=r.filter,g=r.every,y=r.some,b=r.indexOf,w=r.lastIndexOf,E=Array.isArray,S=Object.keys,x=s.bind,T=function(e){if(e instanceof T)return e;if(!(this instanceof T))return new T(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.4.2";var N=T.each=T.forEach=function(e,t,r){if(e==null)return;if(h&&e.forEach===h)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(T.has(e,o)&&t.call(r,e[o],o,e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return e==null?r:p&&e.map===p?e.map(t,n):(N(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduce===d)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);N(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(v&&e.reduceRight===v)return r&&(t=T.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=T.keys(e);s=o.length}N(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.find=T.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},T.filter=T.select=function(e,t,n){var r=[];return e==null?r:m&&e.filter===m?e.filter(t,n):(N(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},T.reject=function(e,t,n){return T.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return e==null?i:g&&e.every===g?e.every(t,r):(N(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return e==null?i:y&&e.some===y?e.some(t,r):(N(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};T.contains=T.include=function(e,t){return e==null?!1:b&&e.indexOf===b?e.indexOf(t)!=-1:C(e,function(e){return e===t})},T.invoke=function(e,t){var n=u.call(arguments,2);return T.map(e,function(e){return(T.isFunction(t)?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t){return T.isEmpty(t)?[]:T.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-Infinity;var r={computed:-Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return Infinity;var r={computed:Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return N(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t);return N(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};T.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)})},T.countBy=function(e,t,n){return L(e,t,n,function(e,t,n){T.has(e,t)||(e[t]=0),e[t]++})},T.sortedIndex=function(e,t,n,r){n=n==null?T.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},T.toArray=function(e){return e?e.length===+e.length?u.call(e):T.values(e):[]},T.size=function(e){return e==null?0:e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,0,t):e[0]},T.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},T.last=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},T.rest=T.tail=T.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},T.compact=function(e){return T.filter(e,function(e){return!!e})};var A=function(e,t,n){return N(e,function(e){T.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};T.flatten=function(e,t){return A(e,t,[])},T.without=function(e){return T.difference(e,u.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){T.isFunction(t)&&(r=n,n=t,t=!1);var i=n?T.map(e,n,r):e,s=[],o=[];return N(i,function(n,r){if(t?!r||o[o.length-1]!==n:!T.contains(o,n))o.push(n),s.push(e[r])}),s},T.union=function(){return T.uniq(a.apply(r,arguments))},T.intersection=function(e){var t=u.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=a.apply(r,u.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){var e=u.call(arguments),t=T.max(T.pluck(e,"length")),n=new Array(t);for(
var r=0;r<t;r++)n[r]=T.pluck(e,""+r);return n},T.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=T.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};T.bind=function(t,n){var r,i;if(t.bind===x&&x)return x.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=t.prototype;var e=new O,s=t.apply(e,i.concat(u.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(u.call(arguments)))}},T.bindAll=function(e){var t=u.call(arguments,1);return t.length==0&&(t=T.functions(e)),N(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(u.call(arguments,1)))},T.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,f<=0?(clearTimeout(i),o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},T.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},T.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},T.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},T.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&(t[t.length]=n);return t},T.values=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push(e[n]);return t},T.pairs=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push([n,e[n]]);return t},T.invert=function(e){var t={};for(var n in e)T.has(e,n)&&(t[e[n]]=n);return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return N(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=M(e[o],t[o],n,r)))break}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(f)&&f instanceof f))return!1;for(var c in e)if(T.has(e,c)){o++;if(!(u=T.has(t,c)&&M(e[c],t[c],n,r)))break}if(u){for(c in t)if(T.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};T.isEqual=function(e,t){return M(e,t,[],[])},T.isEmpty=function(e){if(e==null)return!0;if(T.isArray(e)||T.isString(e))return e.length===0;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!!e&&e.nodeType===1},T.isArray=E||function(e){return l.call(e)=="[object Array]"},T.isObject=function(e){return e===Object(e)},N(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!!e&&!!T.has(e,"callee")}),typeof /./!="function"&&(T.isFunction=function(e){return typeof e=="function"}),T.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return e===!0||e===!1||l.call(e)=="[object Boolean]"},T.isNull=function(e){return e===null},T.isUndefined=function(e){return e===void 0},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},T.random=function(e,t){return t==null&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=T.invert(_.escape);var D={escape:new RegExp("["+T.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(_.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),T.result=function(e,t){if(e==null)return null;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){N(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(T,e))}})};var P=0;T.uniqueId=function(e){var t=P++;return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":o?"';\n"+o+"\n__p+='":"",i=u+t.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,T);var a=function(e){return o.call(this,e,T)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},T.chain=function(e){return T(e).chain()};var F=function(e){return this._chain?T(e).chain():e};T.mixin(T),N(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),N(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),n("underscore",function(e){return function(){var t,n;return t||e._}}(this)),function(){var e=this,n=e.Backbone,r=[],i=r.push,s=r.slice,o=r.splice,u;typeof exports!="undefined"?u=exports:u=e.Backbone={},u.VERSION="1.0.0";var a=e._;!a&&typeof t!="undefined"&&(a=t("underscore")),u.$=e.jQuery||e.Zepto||e.ender||e.$,u.noConflict=function(){return e.Backbone=n,this},u.emulateHTTP=!1,u.emulateJSON=!1;var f=u.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!c(this,"once",e,[t,n])||!t)return this;var r=this,i=a.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,u,f,l,h;if(!this._events||!c(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:a.keys(this._events);for(u=0,f=o.length;u<f;u++){e=o[u];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(l=0,h=s.length;l<h;l++)i=s[l],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&h(n,t),r&&h(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;typeof t=="object"&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},l=/\s+/,c=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){var s=n.split(l);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},h=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},p={listenTo:"on",listenToOnce:"once"};a.each(p,function(e,t){f[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=a.uniqueId("l"));return i[s]=t,typeof n=="object"&&(r=this),t[e](n,r,this),this}}),f.bind=f.on,f.unbind=f.off,a.extend(u,f);var d=u.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=a.uniqueId("c"),this.attributes={},a.extend(this,a.pick(t,v)),t.parse&&(r=this.parse(r,t)||{});if(n=a.result(this,"defaults"))r=a.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},v=["url","urlRoot","collection"];a.extend(d.prototype,f,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return a.clone(this.attributes)},sync:function(){return u.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return a.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,u,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,u=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=a.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],a.isEqual(c[r],t)||o.push(r),a.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!u){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!u)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,a.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,a.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!a.isEmpty(this.changed):a.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?a.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(a.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return a.clone(this._previousAttributes)},fetch:function(e){e=e?a.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},F(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t;if(r&&(!n||!n.wait)&&!this.set(r,n))return!1;n=a.extend({validate:!0},n);if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=a.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var u=this,f=n.success;return n.success=function(e){u.attributes=o;var t=u.parse(e,n);n.wait&&(t=a.extend(r||{},t));if(a.isObject(t)&&!u.set(t,n))return!1;f&&f(u,e,n),u.trigger("sync",u,e,n)},F(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?a.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;F(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=a.result(this,"urlRoot")||a.result(this.collection,"url")||j();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},a.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=a.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,a.extend(t||{},{validationError:n})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];a.each(m,function(e){d.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),a[e].apply(a,t)}});var g=u.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,a.extend({silent:!0},t))},y={add:!0,remove:!0,merge:!0},b={add:!0,merge:!1,remove:!1};a.extend(g.prototype,f,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return u.sync.apply(this,arguments)},add:function(e,t){return this.set(e,a.defaults(t||{},b))},remove:function(e,t){e=a.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},set:function(e,t){t=a.defaults(t||{},y),t.parse&&(e=this.parse(e,t)),a.isArray(e)||(e=e?[e]:[]);var n,r,s,u,f,l,c=t.at,h=this.comparator&&c==null&&t.sort!==!1,p=a.isString(this.comparator)?this.comparator:null,d=[],v=[],m={};for(n=0,r=e.length;n<r;n++){if(!(s=this._prepareModel(e[n],t)))continue;(f=this.get(s))?(t.remove&&(m[f.cid]=!0),t.merge&&(f.set(s.attributes,t),h&&!l&&f.hasChanged(p)&&(l=!0))):t.add&&(d.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,s.id!=null&&(this._byId[s.id]=s))}if(t.remove){for(n=0,r=this.length;n<r;++n)m[(s=this.models[n]).cid]||v.push(s);v.length&&this.remove(v,t)}d.length&&(h&&(l=!0),this.length+=d.length,c!=null?o.apply(this.models,[c,0].concat(d)):i.apply(this.models,d)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,r=d.length;n<r;n++)(s=d[n]).trigger("add",s,this,t);return l&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,a.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return a.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),a.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(a.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=a.isFunction(t)?t:function(e){return e.get(t)};return a.sortedIndex(this.models,e,r,n)},pluck:function(e){return a.invoke(this.models,"get",e)},fetch:function(e){e=e?a.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},F(this,e),this.sync("read",this,e)},create:function(e,t){t=t?a.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var w=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];a.each(w,function(e){g.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),a[e].apply(a,t)}});var E=["groupBy","countBy","sortBy"];a.each(E,function(e){g.prototype[e]=function(t,n){var r=a.isFunction(t)?t:function(e){return e.get(t)};return a[e](this.models,r,n)}});var S=u.View=function(e){this.cid=a.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];a.extend(S.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof u.$?e:u.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=a.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];a.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(x),i=r[1],s=r[2];n=a.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=a.extend({},a.result(this,"options"),e)),a.extend(this,a.pick(e,T)),this.options=e},_ensureElement:function(){if(!this.el){var e=a.extend({},a.result(this,"attributes"));this.id&&(e.id=a.result(this,"id")),this.className&&(e["class"]=a.result(this,"className"));var t=u.$("<"+a.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(a.result(this,"el"),!1)}}),u.sync=function(e,t,n){var r=N[e];a.defaults(n||(n={}),{emulateHTTP:u.emulateHTTP,emulateJSON:u.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=a.result(t,"url")||j()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled)&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var o=n.xhr=u.ajax(a.extend(i,n));return t.trigger("request",t,o,n),o};var N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};u.ajax=function(){return u.$.ajax.apply(u.$,arguments)};var C=u.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},k=/\((.*?)\)/g,L=/(\(\?)?:\w+/g,A=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;a.extend(C.prototype,f,{initialize:function(){},route:function(e,t,n){a.isRegExp(e)||(e=this._routeToRegExp(e)),a.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return u.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),u.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return u.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=a.result(this,"routes");var e,t=a.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(k,"(?:$1)?").replace(L,function(e,t){return t?e:"([^/]+)"}).replace(A,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return a.map(n,function(e){return e?decodeURIComponent(e):null})}});var M=u.History=function(){this.handlers=[],a.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,P=/msie [\w.]+/,H=/\/$/;M.started=!1,a.extend(M.prototype,f,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(H,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(_,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=a.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=P.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(D,"/"),r&&this._wantsHashChange&&(this.iframe=u.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?u.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?u.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){u.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=a.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!M.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),u.history=new M;var B=function(e,t){var n=this,r;e&&a.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},a.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&a.extend(r.prototype,e),r.__super__=n.prototype,r};d.extend=g.extend=C.extend=S.extend=M.extend=B;var j=function(){throw new Error('A "url" property or function must be specified')},F=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),n("backbone",["underscore"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),n("grapher/bar-graph/bar-graph-model",["require","backbone"],function(e){var t=e("backbone"),n=t.Model.extend({defaults:{value:0,secondValue:null,min:0,max:10,barWidth:"2em",height:"20em",title:"",titleOn:"right",barColor:"#e23c34",fillColor:"white",labels:10,units:"",gridLines:10,labelFormat:"0.1f"}});return n}),n("common/jquery-plugins",[],function(){$.fn.measure=function(e,t,n){var r,i,s;return r=$(this).clone(!1),r.css({visibility:"hidden",position:"absolute"}),r.appendTo(n),t?i=r.find(t):i=r,s=e.apply(i),r.remove(),s},$.fn.truncate=function(e){var t=$(this),n=$("<span>"),r,i;n.text(t.text()),n.css({"font-size":t.css("font-size"),"font-weight":t.css("font-weight"),"white-space":"nowrap",visibility:"hidden"}),n.appendTo(t.parent()),r=n.width();if(r>e){i=n.text()+"...",n.text(i);while(r>e&&i.length>3)i=n.text().slice(0,-4)+"...",n.text(i),r=n.width();t.attr("title",t.text()),t.text(i)}n.remove()}}),n("grapher/bar-graph/bar-graph-view",["require","common/jquery-plugins","backbone"],function(e){e("common/jquery-plugins");var t=e("backbone"),n=0,r=function(){return n++},i=function(e){return e.node().getBBox().width},s=16,o=function(e){var t=e/s;return function(e){return e*t}},u=function(e,t){var n=[],r={},i,s;for(i=0,s=t.length;i<s;i++)n[i]=t[i].value,r[n[i]]=t[i].label;e.tickValues(n).tickFormat(function(e){return r[e]})},a=function(e,t){var n=d3.format(e);return function(e){return n(e)+" "+t}},f=t.View.extend({tagName:"div",className:"bar-graph",initialize:function(){this.uid=r(),this.$topArea=$('<div class="top-area">').appendTo(this.$el),this.vis=d3.select(this.el).append("svg"),this.defs=this.vis.append("defs"),this.axisContainer=this.vis.append("g"),this.fill=this.vis.append("rect"),this.bar=this.vis.append("rect"),this.gridContainer=this.vis.append("g"),this.trianglePos=this.vis.append("g"),this.traingle=this.trianglePos.append("polygon"),this.titleContainer=this.vis.append("g"),this.yScale=d3.scale.linear(),this.heightScale=d3.scale.linear(),this.yAxis=d3.svg.axis(),this.scale=null,this.barWidth=null,this.$bottomArea=$('<div class="bottom-area">').appendTo(this.$el),this.model.on("change",this.modelChanged,this)},render:function(){var e=this.model.toJSON(),t=parseFloat(this.$el.css("font-size")),n=this.scale=o(t),r=e.labels>0||e.labels.length>0,s=r?n(8):n(3),f=r?n(8):n(3),l=0;this.$el.outerHeight(e.height),this._setupHorizontalTitle(),this.svgHeight=this.$el.height()-this.$topArea.height()-this.$bottomArea.height(),this.vis.attr({width:600,height:this.svgHeight}),this.yScale.domain([e.min,e.max]).range([this.svgHeight-s,f]).clamp(!0),this.heightScale.domain([e.min,e.max]).range([0,this.svgHeight-s-f]).clamp(!0),this.axisContainer.selectAll("*").remove(),r&&(this.yAxis.scale(this.yScale).tickValues(null).tickPadding(0).tickSize(0,0,0).orient("left"),typeof e.labels=="number"?this.yAxis.ticks(e.labels).tickFormat(a(e.labelFormat,e.units)):u(this.yAxis,e.labels),this.axisContainer.call(this.yAxis),l+=i(this.axisContainer),this.axisContainer.attr("transform","translate("+l+")"),l+=n(5)),this.fill.attr({width:e.barWidth,height:this.heightScale(e.max),x:l,y:this.yScale(e.max),rx:"0.5em",ry:"0.5em",fill:this._getFillGradient(e.fillColor)}),this.bar.attr({width:e.barWidth,x:l,rx:"0.5em",ry:"0.5em",fill:this._getBarGradient(e.barColor)}),this.barWidth=i(this.fill),this.traingle.classed("triangle",!0).attr({points:"15,-7 15,7 1,0",transform:"translate("+l+") scale("+n(1)+")"}),this._setupGrid(l),l+=this.barWidth,l=this._setupTitle(l),this.vis.attr("width",l/t+"em"),this.$el.css("min-width",l/t+"em"),this.$el.css("min-width",l/t+.8+"em"),this.update()},update:function(){var e=this.model.get("value"),t=this.model.get("secondValue");this.bar.attr("height",this.heightScale(e)).attr("y",this.yScale(e)),typeof t!="undefined"&&t!==null?(this.traingle.classed("hidden",!1),this.trianglePos.attr("transform","translate(0,"+this.yScale(t)+")")):this.traingle.classed("hidden",!0)},modelChanged:function(){var e=this.model.changedAttributes(),t=0,n,r,i;for(i in e)if(e.hasOwnProperty(i)){t++;if(t>2){this.render();return}}n=typeof e.value!="undefined",r=typeof e.secondValue!="undefined",t===1&&(n||r)||t===2&&n&&r?this.update():this.render()},_getBarGradient:function(e){var t="bar-gradient-"+this.uid,n=this.defs.select("#"+t);return e=d3.rgb(e),n.empty()?n=this.defs.append("linearGradient").attr("id",t).attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%"):n.selectAll("stop").remove(),n.append("stop").attr("stop-color",e.brighter(2).toString()).attr("offset","0%"),n.append("stop").attr("stop-color",e.toString()).attr("offset","100%"),"url(#"+t+")"},_getFillGradient:function(e){var t="fill-gradient-"+this.uid,n=this.defs.select("#"+t);return n.empty()?n=this.defs.append("linearGradient").attr("id",t).attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%"):n.selectAll("stop").remove(),n.append("stop").attr("stop-color",e).attr("offset","0%"),n.append("stop").attr("stop-color",e).attr("stop-opacity",.5).attr("offset","15%"),n.append("stop").attr("stop-color",e).attr("stop-opacity",.4).attr("offset","100%"),"url(#"+t+")"},_setupGrid:function(e){var t=this.yScale.ticks(this.model.get("gridLines")),n=this.yScale,r=this.barWidth;return t.pop(),t.shift(),this.grid=this.gridContainer.selectAll(".grid-line").data(t,String),this.grid.enter().append("path").attr("class","grid-line"),this.grid.exit().remove(),this.grid.attr("d",function(t){return"M "+e+" "+Math.round(n(t))+" h "+r}),e},_setupTitle:function(e){var t=this.model.get("title"),n=this,r,i,s,o;return t&&this.model.get("titleOn")==="right"&&(e+=this.scale(10),r=$.isArray(t),i=r?t.length:1,s=this.titleContainer.selectAll(".title").data(r?t:[t]),s.exit().remove(),o=s.enter().append("g").attr("class","title"),o.append("title"),o.append("text"),s.each(function(e,t){var r=d3.select(this);r.select("title").text(e),r.select("text").text(n._processTitle(e)).attr("dy",-(i-t-1)+"em"
)}),this.titleContainer.attr("transform","translate("+e+", "+this.svgHeight/2+") rotate(90)"),e+=parseFloat($(s.node()).css("font-size"))*i),e},_setupHorizontalTitle:function(){var e=this.model.get("title"),t=this.model.get("titleOn"),n;this.$topArea.empty(),this.$bottomArea.empty();if(!e||e.length===0||t==="right")return;e=$.isArray(e)?e:[e],t==="top"?n=this.$topArea:t==="bottom"&&(n=this.$bottomArea),e.forEach(function(e){n.append('<p class="title">'+e+"</p>")})},_processTitle:function(e){var t=$('<span class="title">'+e+"</span>").appendTo(this.$el),n;return t.truncate(this.svgHeight),n=t.text(),t.remove(),n}});return f}),n("grapher/public-api",["require","../lab.version","../lab.config","grapher/core/graph","grapher/bar-graph/bar-graph-model","grapher/bar-graph/bar-graph-view"],function(e){"use strict";var t=e("../lab.version"),n=e("../lab.config"),r=e("grapher/core/graph"),i=e("grapher/bar-graph/bar-graph-model"),s=e("grapher/bar-graph/bar-graph-view"),o;return o={version:"0.0.1",Graph:r,BarGraphModel:i,BarGraphView:s},window.Lab=window.Lab||{},window.Lab.config=n,window.Lab.grapher=o,o}),t(["grapher/public-api"],undefined,undefined,!0)})();